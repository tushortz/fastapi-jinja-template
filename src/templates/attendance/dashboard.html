{% extends "base.html" %}

{% block title %}Attendance Dashboard{% endblock %}
{% block page_title %}Attendance{% endblock %}

{% block content %}
<div class="space-y-6">

  <!-- Statistics Cards -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
    <!-- Total Records -->
    <div class="bg-white shadow rounded-lg p-6">
      <div class="flex items-center">
        <div class="flex-shrink-0">
          <div class="w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center">
            <i class="fas fa-clipboard-list text-white"></i>
          </div>
        </div>
        <div class="ml-4">
          <p class="text-sm font-medium text-gray-500">Total Records</p>
          <p class="text-2xl font-semibold text-gray-900">{{ stats.total_records }}</p>
        </div>
      </div>
    </div>

    <!-- Present Count -->
    <div class="bg-white shadow rounded-lg p-6">
      <div class="flex items-center">
        <div class="flex-shrink-0">
          <div class="w-8 h-8 bg-green-500 rounded-md flex items-center justify-center">
            <i class="fas fa-check-circle text-white"></i>
          </div>
        </div>
        <div class="ml-4">
          <p class="text-sm font-medium text-gray-500">Present</p>
          <p class="text-2xl font-semibold text-gray-900">{{ stats.present_count }}</p>
        </div>
      </div>
    </div>

    <!-- Absent Count -->
    <div class="bg-white shadow rounded-lg p-6">
      <div class="flex items-center">
        <div class="flex-shrink-0">
          <div class="w-8 h-8 bg-red-500 rounded-md flex items-center justify-center">
            <i class="fas fa-times-circle text-white"></i>
          </div>
        </div>
        <div class="ml-4">
          <p class="text-sm font-medium text-gray-500">Absent</p>
          <p class="text-2xl font-semibold text-gray-900">{{ stats.absent_count }}</p>
        </div>
      </div>
    </div>

    <!-- Attendance Rate -->
    <div class="bg-white shadow rounded-lg p-6">
      <div class="flex items-center">
        <div class="flex-shrink-0">
          <div class="w-8 h-8 bg-yellow-500 rounded-md flex items-center justify-center">
            <i class="fas fa-percentage text-white"></i>
          </div>
        </div>
        <div class="ml-4">
          <p class="text-sm font-medium text-gray-500">Attendance Rate</p>
          <p class="text-2xl font-semibold text-gray-900">{{ "%.1f"|format(stats.attendance_rate) }}%</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Attendance -->
  {% if recent_attendance %}
  <div class="bg-white shadow rounded-lg p-6">
    <h2 class="text-lg font-semibold text-gray-900 mb-4">Recent Attendance Records</h2>
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Member</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Service</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          {% for record in recent_attendance %}
          <tr class="hover:bg-gray-50">
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              {{ record.member_id }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              {{ record.attendance_date.strftime('%B %d, %Y') }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              {{ record.attendance_type.replace('_', ' ').title() }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full
                {% if record.status == 'present' %}bg-green-100 text-green-800
                {% elif record.status == 'absent' %}bg-red-100 text-red-800
                {% elif record.status == 'late' %}bg-yellow-100 text-yellow-800
                {% elif record.status == 'excused' %}bg-blue-100 text-blue-800
                {% else %}bg-gray-100 text-gray-800{% endif %}">
                {{ record.status.replace('_', ' ').title() }}
              </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              {{ record.service_time or '-' }}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% endif %}

  <!-- Quick Actions -->
  <div class="bg-white shadow rounded-lg p-6">
    <h2 class="text-lg font-semibold text-gray-900 mb-4">Quick Actions</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
      <a href="{{ url_for('create_attendance_form') }}"
         class="flex items-center p-4 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors">
        <i class="fas fa-plus text-blue-600 mr-3"></i>
        <span class="text-blue-800 font-medium">Record Attendance</span>
      </a>
      <a href="{{ url_for('attendance_list') }}"
         class="flex items-center p-4 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition-colors">
        <i class="fas fa-list text-green-600 mr-3"></i>
        <span class="text-green-800 font-medium">View All Records</span>
      </a>
      <a href="{{ url_for('members_dashboard') }}"
         class="flex items-center p-4 bg-yellow-50 border border-yellow-200 rounded-lg hover:bg-yellow-100 transition-colors">
        <i class="fas fa-users text-yellow-600 mr-3"></i>
        <span class="text-yellow-800 font-medium">Manage Members</span>
      </a>
      <a href="{{ url_for('events_dashboard') }}"
         class="flex items-center p-4 bg-purple-50 border border-purple-200 rounded-lg hover:bg-purple-100 transition-colors">
        <i class="fas fa-calendar-plus text-purple-600 mr-3"></i>
        <span class="text-purple-800 font-medium">Manage Activities</span>
      </a>
    </div>
  </div>
</div>
{% endblock %}
